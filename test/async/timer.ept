open Time
open Iostream


(* [period] is given in milliseconds.
   [b] should be always equal to [true]
     otherwise it means we missed a deadline. *)
unsafe node periodic_clock<<period :int>> () returns (b :bool)
var date : time;
let
  date = add_time((start_time()) fby date, period);
  b = sleep_until(date);
  () = if b then () else  printf("__ -- Missed deadline -- __");
tel




unsafe node main() returns (b:bool)
let
  b = periodic_clock<<50>>();
tel
